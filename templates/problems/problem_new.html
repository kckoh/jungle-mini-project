{% extends 'base.html' %} {% block title %}새 알고리즘 작성{% endblock %} {%
block content %}
<div class="max-w-5xl mx-auto px-0">
    <!-- 본문 카드 -->
    <form class="border border-gray-200 rounded-xl bg-white overflow-hidden">
        <!-- 카드 콘텐츠 -->
        <div class="p-4 md:p-6 space-y-6">
            <!-- 제목 -->
            <section class="space-y-2">
                <label class="text-sm font-medium" for="title">제목</label>
                <input
                    id="title"
                    name="title"
                    type="text"
                    required
                    placeholder="예: 구간 합 구하기 (BOJ 11659)"
                    class="w-full border border-gray-200 rounded-lg px-3 py-2 text-sm outline-black"
                />
            </section>

            <!-- 내용 -->
            <section class="space-y-2">
                <div class="flex items-center justify-between">
                    <label class="text-sm font-medium" for="content"
                        >내용</label
                    >
                </div>
                <textarea
                    id="content"
                    name="content"
                    placeholder="내용을 입력해주세요..."
                    class="w-full border border-gray-200 rounded-lg px-3 py-2 text-sm min-h-36 outline-black"
                ></textarea>
            </section>
            <!-- 접근 방식  -->
            <section class="space-y-2">
                <div class="flex items-center justify-between">
                    <label class="text-sm font-medium" for="content"
                        >접근 방식</label
                    >
                </div>
                <textarea
                    id="approach"
                    name="approach"
                    placeholder="접근 방식을 입력해주세요..."
                    class="w-full border border-gray-200 rounded-lg px-3 py-2 text-sm min-h-36 outline-black"
                ></textarea>
            </section>

            <!-- 저장 버튼 -->
            <div class="pt-2 text-right">
                <button
                    id="saveButton"
                    type="button"
                    class="inline-flex items-center gap-2 px-4 py-2 rounded-md bg-black text-white text-sm font-semibold hover:brightness-95"
                >
                    저장
                </button>
            </div>
        </div>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const saveButton = document.getElementById("saveButton");
        const titleInput = document.getElementById("title");
        const contentInput = document.getElementById("content");
        const approachInput = document.getElementById("approach");

        saveButton.addEventListener("click", function () {
            const title = titleInput.value.trim();
            const content = contentInput.value.trim();
            const approach = approachInput.value.trim();

            if (!title || !content || !approach) {
                alert("제목과 내용을 모두 입력해주세요!");
                return;
            }

            fetch("/api/posts", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    title: title,
                    description: content,
                    approach: approach,
                }),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.success) {
                        alert("알고리즘이 성공적으로 저장되었습니다.");
                        window.location.href = `/problems`;
                    } else {
                        alert(
                            "알고리즘 저장에 실패했습니다. 다시 시도해주세요.",
                        );
                    }
                })
                .catch((error) => {
                    console.error("Error:", error);
                    alert(
                        "서버 오류가 발생했습니다. 나중에 다시 시도해주세요.",
                    );
                });
        });
    });
</script>

{% endblock %}
